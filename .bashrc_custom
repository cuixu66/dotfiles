# Xu Cui's customized .bashrc_cutom file

platform='unknown'
unamestr=`uname`
if [[ "$unamestr" == 'Linux' ]]; then
   platform='linux'
elif [[ "$unamestr" == 'FreeBSD' ]]; then
   platform='freebsd'
fi


# emacs shortcut
alias e='emacs -nw'

# useless shoshin vpn alias
alias shoshin_vpn='cd ~/School/shoshin_vpn/shoshin-vpn/; sudo openvpn ./shoshin.conf'

# making prompt more readable
# for detailed documentation read the following links
# http://www.gentoo.org/doc/en/articles/prompt-magic.xml
HOSTNAME_HASH=$(md5sum <<< `hostname`)
HOSTNAME_COLOR=$((0x${HOSTNAME_HASH%% *}))
if [ $HOSTNAME_COLOR -lt 0 ]; then
    HOSTNAME_COLOR=$((0 - $HOSTNAME_COLOR))
fi
HOSTNAME_COLOR=$((HOSTNAME_COLOR % 691 % 7))
HOSTNAME_COLOR=$((HOSTNAME_COLOR + 31))

if [ "`whoami`" = 'root' ]
then
        PS1="\[\033[31;1m\][\u@\[\033[0;${HOSTNAME_COLOR}m\]\h:\[\033[31;1m\]\w]\\$\[\033[0m\]"
else
        PS1="\[\033[0;37;1m\][\u@\[\033[0;${HOSTNAME_COLOR}m\]\h:\[\033[0;37;1m\]\w]\\$\[\033[0m\]"
fi
#PS1="$ \[\033[0m\]"

# enable color support of ls and also add handy aliases
if [[ $platform == 'linux' ]]; then
   alias ls='ls --color=auto'
elif [[ $platform == 'freebsd' ]]; then
   alias ls='ls -G'
fi
alias ll='ls -alFG'

# history will ignore both duplicates and spaces; this also erases duplicated entries in history
export HISTCONTROL=ignoreboth:erasedups

# control-D will not exit right away
export IGNOREEOF=3

# terminal setting is stored in ~/.dir_colors
eval `dircolors -b ~/.dir_colors`


## show color in man page ##
export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_md=$'\E[01;31m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_so=$'\E[01;44;33m'
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;32m'
export LESS_TERMCAP_mb=$'\E[01;31m'
## show color in man page ##

# HISTSIZE     --> number of lines of command to store in history "list" (memory)
# HISTFILESIZE --> number of lines of command to store in history "file"
# The history "file" is not updated as you type the commands.
# The commands get stored in a "list" separately (accessed by the history command).
# The number of these stored commands is controlled by HISTSIZE  value.
# When the shell (interactive) exits, the last  $HISTSIZE  lines are copied/appended to  $HISTFILE  from that "list".
# If  HISTFILESIZE  is set, then after this operation, it is ensured that only  $HISTFILESIZE  lines (latest) exist in  $HISTFILE .
# And when the shell starts, the "list" is initialized from  $HISTFILE  upto a maximum of  $HISTSIZE  commands.
# Source : http://www.unix.com/unix-dummies-questions-answers/191301-histsize-histfilesize.html by elixir_sinari

export HISTSIZE=10000
export HISTFILESIZE=10000

# diffdir is a function to compare to directories recursively
diffdir(){
	if [ $# -ne 2 ]
	then
		echo "Usage: diffdir dir_one dir_two"
		return 16666
	fi
	diff --brief -bur ${1} ${2}
}

# export byobu directory so byobu will read my configurations
export BYOBU_PREFIX=${HOME}/dotfiles/.byobu/SRC_GIT/byobu/usr
export PATH=${HOME}/dotfiles/.byobu/SRC_GIT/byobu/usr/bin/:"$PATH"

# create shortcut to open files in with x11
# also this only works after you installed ubuntu-desktop
# i.e. sudo apt-get update; sudo apt-get upgrade; sudo apt-get install ubuntu-desktop
# to disable GUI from starting during boot, add "text" after "GRUB_CMDLINE_LINUX_DEFAULT=" in /etc/default/grub
# gvfs-open replaced gnome-open after ubuntu 12.04
# source http://askubuntu.com/questions/101965/what-is-the-replacement-for-gnome-open-in-gnome
alias g='gvfs-open'
# This line is used to get rid of the warning message when I use x11
# source http://askubuntu.com/questions/227515/terminal-warning-when-opening-a-file-in-gedit
export NO_AT_BRIDGE=1

# set python class path for my python library for my master's studies
export PYTHONPATH="${HOME}/xcui_sandbox/pmaster:PYTHONPATH"

### Added by the Heroku Toolbelt because of startup engineering class from courera
export PATH="/usr/local/heroku/bin:$PATH"

# clean up duplicates in PATH varabile
# Note duplicate is only introduced when running byobu and I couldn't figure out why
# source of this solution:
# http://unix.stackexchange.com/questions/14895/duplicate-entries-in-path-a-problem
PATH=$(echo "$PATH" | awk -v RS=':' -v ORS=":" '!a[$1]++{if (NR > 1) printf ORS; printf $a[$1]}')

source ${HOME}/dotfiles/xcui_commands.bash

# source vm_specific file at the end so overwrite works
if [ -f ${HOME}/dotfiles/.bashrc_vm_specific ]
then
   source ${HOME}/dotfiles/.bashrc_vm_specific
fi

# enables xterm forwarding
alias ssh='ssh -X'
